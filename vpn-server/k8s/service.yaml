apiVersion: v1
kind: Service
metadata:
  name: vpn-server
  namespace: iotistic-vpn
  labels:
    app: vpn-server
    component: vpn-gateway
spec:
  type: LoadBalancer
  ports:
  - name: openvpn
    port: 1194
    targetPort: 1194
    protocol: UDP
  selector:
    app: vpn-server

---
apiVersion: v1
kind: Service
metadata:
  name: vpn-api
  namespace: iotistic-vpn
  labels:
    app: vpn-server
    component: api
spec:
  type: ClusterIP
  ports:
  - name: api
    port: 3200
    targetPort: 3200
    protocol: TCP
  - name: management
    port: 7505
    targetPort: 7505
    protocol: TCP
  selector:
    app: vpn-server

---
# Optional: NodePort for development/testing
apiVersion: v1
kind: Service
metadata:
  name: vpn-server-nodeport
  namespace: iotistic-vpn
  labels:
    app: vpn-server
    component: vpn-gateway-dev
spec:
  type: NodePort
  ports:
  - name: openvpn
    port: 1194
    targetPort: 1194
    protocol: UDP
    nodePort: 31194
  - name: api
    port: 3200
    targetPort: 3200
    protocol: TCP
    nodePort: 32200
  selector:
    app: vpn-server